@page "{matchId:int}"
@model Tabletennis.Pages.Matches.ActiveMatchModel
@{
    ViewData["Title"] = "Active Match";
}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
crossorigin="anonymous"
referrerpolicy="no-referrer" />

<div class="container mt-4">
    @if (@Model.ActiveMatchVM.IsSetCompleted)
    { 
        <partial name="_StartSet" model="Model.ActiveMatchVM" />
    }
    else if (!@Model.ActiveMatchVM.IsSetCompleted)
    {
        <div class="row mb-3">
            <div class="col-6 text-center">
                <span class="anta-regular">Set-tid: <span id="set-timer"></span></span>
            </div>
            <div class="col-6 text-center">
                <span class="anta-regular">Match-tid: <span id="match-timer"></span></span>
            </div>
        </div>
        <partial name="_ScoreBoard" model="Model.ActiveMatchVM" />
    }
    else if (@Model.ActiveMatchVM.IsCompleted)
    {
        <partial name="_EndGame" model="Model.ActiveMatchVM" />
    }
</div>

@section Scripts {
    <script>
        // Byt ut till r√§tt property-namn om de heter annorlunda i din ViewModel
        const setStart = new Date('@Model.ActiveMatchVM.SetStartTime.ToString("o")');
        const matchStart = new Date('@Model.ActiveMatchVM.MatchStartTime.ToString("o")');
        function updateTimers() {
            const now = new Date();
            const setDiff = new Date(now - setStart);
            const matchDiff = new Date(now - matchStart);
            document.getElementById('set-timer').innerText =
                setDiff.getUTCHours().toString().padStart(2, '0') + ':' +
                setDiff.getUTCMinutes().toString().padStart(2, '0') + ':' +
                setDiff.getUTCSeconds().toString().padStart(2, '0');
            document.getElementById('match-timer').innerText =
                matchDiff.getUTCHours().toString().padStart(2, '0') + ':' +
                matchDiff.getUTCMinutes().toString().padStart(2, '0') + ':' +
                matchDiff.getUTCSeconds().toString().padStart(2, '0');
        }
        setInterval(updateTimers, 1000);
        updateTimers();
    </script>
}
